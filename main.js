var L=r=>{throw TypeError(r)};var v=(r,e,t)=>e.has(r)||L("Cannot "+t);var i=(r,e,t)=>(v(r,e,"read from private field"),t?t.call(r):e.get(r)),y=(r,e,t)=>e.has(r)?L("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(r):e.set(r,t),w=(r,e,t,o)=>(v(r,e,"write to private field"),o?o.call(r,t):e.set(r,t),t);import{a as V,S as j,i as P}from"./assets/vendor-B9mnahA8.js";(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))o(s);new MutationObserver(s=>{for(const a of s)if(a.type==="childList")for(const d of a.addedNodes)d.tagName==="LINK"&&d.rel==="modulepreload"&&o(d)}).observe(document,{childList:!0,subtree:!0});function t(s){const a={};return s.integrity&&(a.integrity=s.integrity),s.referrerPolicy&&(a.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?a.credentials="include":s.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function o(s){if(s.ep)return;s.ep=!0;const a=t(s);fetch(s.href,a)}})();var c,u;class A{constructor(e={}){y(this,c,{});y(this,u,{});w(this,c,{...e})}getState(e){return i(this,c)[e]}setState(e,t){i(this,c)[e]!==t&&(i(this,c)[e]=t,this.notify(e))}subscribe(e,t){i(this,u)[e]||(i(this,u)[e]=[]),i(this,u)[e].push(t),t(i(this,c)[e],i(this,c))}notify(e){if(i(this,u)[e])for(const t of i(this,u)[e])t(i(this,c)[e],i(this,c))}}c=new WeakMap,u=new WeakMap;const K="https://us-central1-dev-test-448809.cloudfunctions.net/pixabayProxy/";function C(r,e="1"){const t=new URLSearchParams({q:encodeURIComponent(r),image_type:"photo",orientation:"horizontal",safesearch:"true",per_page:"15",page:e}),o=`${K}?${t}`;return V.get(o).then(s=>s.data).catch(s=>{throw console.error("Error:",s),s})}function T(r){const e=document.querySelector(".loader");return r?e==null||e.classList.remove("hidden"):e==null||e.classList.add("hidden"),e}function M(r,e,t){console.log("renderButtonMore called",{images:r,loading:e});const o=document.querySelector(".button-load-more");e||r.length===0||t===-1?o==null||o.classList.add("hidden"):o==null||o.classList.remove("hidden")}function O(r,e){const t=document.querySelector(".gallery");e&&!t.innerHTML?t==null||t.classList.add("hidden"):t==null||t.classList.remove("hidden");const o=Array.from(t.querySelectorAll("a.gallery-link")).map(l=>l.dataset.id),s=r.map(l=>l.id);if(o.join("|")===s.join("|"))return;const a=document.querySelector("#gallery-item-template"),d=document.createDocumentFragment();if(r.forEach(({id:l,webformatURL:p,largeImageURL:S,tags:b,likes:$,comments:D,views:B,downloads:F})=>{const h=a.content.cloneNode(!0),q=h.querySelector("a.gallery-link"),m=h.querySelector("img.gallery-image");q.dataset.id=l,q.href=S,m.src=p,m.alt=b,m.title=b,m.dataset.source=S;const g=h.querySelector(".gallery-item-meta"),N=g.querySelector(".meta-likes-value"),_=g.querySelector(".meta-views-value"),z=g.querySelector(".meta-comments-value"),I=g.querySelector(".meta-downloads-value");N.textContent=`${$||0}`,_.textContent=`${B||0}`,z.textContent=`${D||0}`,I.textContent=`${F||0}`,d.appendChild(h)}),t.innerHTML="",t.appendChild(d),t._instance)t._instance.refresh();else{const l=new j(".gallery a",{captions:!0,captionDelay:250,captionPosition:"bottom"});l.on("show.simplelightbox",function(...p){}),l.on("error.simplelightbox",function(...p){}),t._instance=l}}P.settings({position:"topRight",timeout:2e3,close:!1,progressBar:!1,transitionIn:"bounceInUp",transitionOut:"fadeOutDown"});const x={success:"#4caf50",error:"#f44336"},U={success:"fas fa-check",error:"fas fa-ban"};function f(r,e="success"){P[e]({message:r,icon:U[e]||"fas fa-info",iconColor:x[e]||"#ddd",progressBarColor:x[e]||"#ddd"})}const n=new A({loading:!1,images:[],page:1,search:""});n.subscribe("loading",T);n.subscribe("loading",(r,{images:e})=>O(e,r));n.subscribe("images",(r,{loading:e})=>O(r,e));n.subscribe("loading",(r,{images:e,page:t})=>M(e,r,t));n.subscribe("images",(r,{loading:e,page:t})=>M(r,e,t));(function(){const e=document.querySelector(".form");e==null||e.addEventListener("submit",t=>{t.preventDefault();const o=new FormData(e),s=Object.fromEntries(o.entries());if(!s.search){f("Please enter a search query","error");return}if(s.search===n.getState("search")){f(`You already searched for "${s.search}"`,"error");return}n.setState("images",[]),n.setState("search",s.search),n.setState("page",1),n.setState("loading",!0),C(s.search,"1").then(a=>{if(a.hits.length===0){f("Sorry, there are no images matching your search query. Please try again!","error");return}n.setState("images",a.hits)}).catch(a=>{console.error("Error fetching images:",a),f("Error fetching images","error")}).finally(()=>{n.setState("loading",!1)})})})();(function(){const e=document.querySelector(".button-load-more");e==null||e.addEventListener("click",()=>{const t=n.getState("search");n.setState("loading",!0);const o=n.getState("page")+1;n.setState("page",o),C(t,o).then(s=>{if(s.hits.length===0){f(`No more images found for "${t}"`,"error"),n.setState("page",-1);return}n.setState("images",[...n.getState("images"),...s.hits])}).catch(s=>{console.error("Error fetching more images:",s),f("Error fetching more images","error")}).finally(()=>{n.setState("loading",!1)})})})();
