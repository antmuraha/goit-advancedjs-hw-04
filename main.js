var L=r=>{throw TypeError(r)};var w=(r,e,t)=>e.has(r)||L("Cannot "+t);var a=(r,e,t)=>(w(r,e,"read from private field"),t?t.call(r):e.get(r)),y=(r,e,t)=>e.has(r)?L("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(r):e.set(r,t),v=(r,e,t,s)=>(w(r,e,"write to private field"),s?s.call(r,t):e.set(r,t),t);import{a as _,S as z,i as P}from"./assets/vendor-B9mnahA8.js";(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))s(o);new MutationObserver(o=>{for(const n of o)if(n.type==="childList")for(const d of n.addedNodes)d.tagName==="LINK"&&d.rel==="modulepreload"&&s(d)}).observe(document,{childList:!0,subtree:!0});function t(o){const n={};return o.integrity&&(n.integrity=o.integrity),o.referrerPolicy&&(n.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?n.credentials="include":o.crossOrigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function s(o){if(o.ep)return;o.ep=!0;const n=t(o);fetch(o.href,n)}})();var c,u;class j{constructor(e={}){y(this,c,{});y(this,u,{});v(this,c,{...e})}getState(e){return a(this,c)[e]}setState(e,t){a(this,c)[e]!==t&&(a(this,c)[e]=t,this.notify(e))}subscribe(e,t){a(this,u)[e]||(a(this,u)[e]=[]),a(this,u)[e].push(t),t(a(this,c)[e],a(this,c))}notify(e){if(a(this,u)[e])for(const t of a(this,u)[e])t(a(this,c)[e],a(this,c))}}c=new WeakMap,u=new WeakMap;const A="https://us-central1-dev-test-448809.cloudfunctions.net/pixabayProxy/";function C(r,e="1"){const t=new URLSearchParams({q:encodeURIComponent(r),image_type:"photo",orientation:"horizontal",safesearch:"true",per_page:"15",page:e}),s=`${A}?${t}`;return _.get(s).then(o=>o.data).catch(o=>{throw console.error("Error:",o),o})}function K(r){const e=document.querySelector(".loader");return r?e==null||e.classList.remove("hidden"):e==null||e.classList.add("hidden"),e}function $(r,e,t){console.log("renderButtonMore called",{images:r,loading:e});const s=document.querySelector(".button-load-more");e||r.length===0||t===-1?s==null||s.classList.add("hidden"):s==null||s.classList.remove("hidden")}function M(r,e){const t=document.querySelector(".gallery");e&&!t.innerHTML?t==null||t.classList.add("hidden"):t==null||t.classList.remove("hidden");const s=Array.from(t.querySelectorAll("a.gallery-link")).map(l=>l.dataset.id),o=r.map(l=>l.id);if(s.join("|")===o.join("|"))return;const n=document.querySelector("#gallery-item-template"),d=document.createDocumentFragment();if(r.forEach(({id:l,webformatURL:p,largeImageURL:S,tags:b,likes:O,comments:T,views:B,downloads:D})=>{const h=n.content.cloneNode(!0),q=h.querySelector("a.gallery-link"),m=h.querySelector("img.gallery-image");q.dataset.id=l,q.href=S,m.src=p,m.alt=b,m.title=b,m.dataset.source=S;const g=h.querySelector(".gallery-item-meta"),F=g.querySelector(".meta-likes-value"),I=g.querySelector(".meta-views-value"),N=g.querySelector(".meta-comments-value"),V=g.querySelector(".meta-downloads-value");F.textContent=`${O||0}`,I.textContent=`${B||0}`,N.textContent=`${T||0}`,V.textContent=`${D||0}`,d.appendChild(h)}),t.innerHTML="",t.appendChild(d),t._instance)t._instance.refresh();else{const l=new z(".gallery a",{captions:!0,captionDelay:250,captionPosition:"bottom"});l.on("show.simplelightbox",function(...p){}),l.on("error.simplelightbox",function(...p){}),t._instance=l}}function U(r){setTimeout(()=>{const e=document.querySelector(`a[data-id="${r}"]`);if(e){const t=document.createElement("div");t.style.position="absolute",t.style.top="-20px",e.insertBefore(t,e.firstChild),t.scrollIntoView({behavior:"smooth",block:"start",inline:"nearest"})}else console.warn(`Tile with id ${r} not found`)},200)}P.settings({position:"topRight",timeout:2e3,close:!1,progressBar:!1,transitionIn:"bounceInUp",transitionOut:"fadeOutDown"});const x={success:"#4caf50",error:"#f44336"},H={success:"fas fa-check",error:"fas fa-ban"};function f(r,e="success"){P[e]({message:r,icon:H[e]||"fas fa-info",iconColor:x[e]||"#ddd",progressBarColor:x[e]||"#ddd"})}const i=new j({loading:!1,images:[],page:1,search:""});i.subscribe("loading",K);i.subscribe("loading",(r,{images:e})=>M(e,r));i.subscribe("images",(r,{loading:e})=>M(r,e));i.subscribe("loading",(r,{images:e,page:t})=>$(e,r,t));i.subscribe("images",(r,{loading:e,page:t})=>$(r,e,t));(function(){const e=document.querySelector(".form");e==null||e.addEventListener("submit",t=>{t.preventDefault();const s=new FormData(e),o=Object.fromEntries(s.entries());if(!o.search){f("Please enter a search query","error");return}if(o.search===i.getState("search")){f(`You already searched for "${o.search}"`,"error");return}i.setState("images",[]),i.setState("search",o.search),i.setState("page",1),i.setState("loading",!0),C(o.search,"1").then(n=>{if(n.hits.length===0){f("Sorry, there are no images matching your search query. Please try again!","error");return}i.setState("images",n.hits)}).catch(n=>{console.error("Error fetching images:",n),f("Error fetching images","error")}).finally(()=>{i.setState("loading",!1)})})})();(function(){const e=document.querySelector(".button-load-more");e==null||e.addEventListener("click",()=>{const t=i.getState("search");i.setState("loading",!0);const s=i.getState("page")+1;i.setState("page",s),C(t,s).then(o=>{var n;if(o.hits.length===0){f(`No more images found for "${t}"`,"error"),i.setState("page",-1);return}i.setState("images",[...i.getState("images"),...o.hits]),U((n=o.hits[0])==null?void 0:n.id)}).catch(o=>{console.error("Error fetching more images:",o),f("Error fetching more images","error")}).finally(()=>{i.setState("loading",!1)})})})();
